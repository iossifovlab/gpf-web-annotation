<div *ngIf="report" id="report">
  <div id="toggle-view-container">
    <input class="switch" type="checkbox" checked="true" (change)="showFullReport = !showFullReport" />
    <label [ngStyle]="{ color: !showFullReport ? '#85a2b9' : '#5b778c' }">compact report</label>
  </div>

  <div id="variant">
    <div id="report-header">
      <span id="variant-header">Variant</span>
      <span id="download-report" download>
        <button (click)="saveReport()" id="download-report-button"
          ><span class="material-symbols-outlined download-icon">download</span>Download report</button
        >
      </span>
    </div>
    <div id="variant-data-container">
      <div>
        <div class="variant-data-label">chromosome</div>
        <div class="variant-data" id="variant-chromosome">{{ report.variant.chromosome }}</div>
      </div>
      <hr />
      <div>
        <div class="variant-data-label">position</div>
        <div class="variant-data" id="variant-position">{{ report.variant.position }}</div>
      </div>
      <hr />
      <div>
        <div class="variant-data-label">reference</div>
        <div class="variant-data" id="variant-reference">{{ report.variant.reference }}</div>
      </div>
      <hr />
      <div>
        <div class="variant-data-label">alternative</div>
        <div class="variant-data" id="variant-alternate">{{ report.variant.alternative }}</div>
      </div>
      <hr />
      <div>
        <div class="variant-data-label">variant type</div>
        <div class="variant-data" id="variant-type">{{ report.variant.variantType }}</div>
      </div>
    </div>
  </div>

  <div id="annotators">
    <div *ngFor="let annotator of report.annotators" class="annotator">
      <div class="attributes">
        <div *ngFor="let attribute of annotator.attributes" class="attribute-container">
          <div class="attribute">
            <div class="attribute-header">{{ attribute.name }}</div>
            <div *ngIf="showFullReport" class="attribute-description">{{ attribute.description }}</div>
            <div *ngIf="showFullReport" class="attribute-source">source: {{ attribute.source }}</div>
          </div>
          <div class="attribute-result">
            <div
              class="value-result"
              [ngStyle]="{ 'margin-top': showFullReport ? '20px' : '0' }"
              *ngIf="!tableViewSources.includes(attribute.source)"
              >{{ attribute.result.value | formatResultValue }}</div
            >
            <div
              *ngIf="
                tableViewSources.includes(attribute.source) &&
                annotator.details.name === 'effect_annotator' &&
                attribute.result.value
              ">
              <app-effect-table
                [rawEffectDetails]="attribute.result.value.toString()"
                [source]="attribute.source"></app-effect-table>
            </div>
            <app-histogram-wrapper
              *ngIf="showFullReport && attribute.result.histogramLink"
              [histogramUrl]="attribute.result.histogramLink"
              [value]="attribute.result.value"></app-histogram-wrapper>
          </div>
        </div>
      </div>

      <div id="compact-report">
        <span class="material-symbols-outlined info-icon" (click)="showInfo(annotator)">info</span>

        <ng-template #infoModal let-annotator>
          <div id="modal-content">
            <div style="width: 100%">
              <div *ngFor="let attribute of annotator.attributes" class="attribute-container-modal">
                <div class="attribute-header">{{ attribute.name }}</div>
                <div class="attribute-description">{{ attribute.description }}</div>
                <div class="attribute-source">source: {{ attribute.source }}</div>
                <div>
                  <app-histogram-wrapper
                    *ngIf="attribute.result.histogramLink"
                    [histogramUrl]="attribute.result.histogramLink"
                    [value]="attribute.result.value"></app-histogram-wrapper>
                </div>
              </div>
            </div>
            <div class="annotator-details">
              <div>
                <div class="annotator-label"
                  ><span class="annotator-header">{{ annotator.details.name }}</span></div
                >
                <markdown class="annotator-description">{{ annotator.details.description }}</markdown>
              </div>

              <div *ngIf="annotator.details.resources.length" class="resources">
                <div *ngFor="let resource of annotator.details.resources" class="resource">
                  <div class="resource-label">Resource</div>
                  <div
                    ><span class="id-label">id: </span>
                    <a target="_blank" [href]="resource.resourceUrl" class="annotator-resource">{{
                      resource.resourceId
                    }}</a></div
                  >
                </div>
              </div>
            </div>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
